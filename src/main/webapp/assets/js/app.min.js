! function(a, b) {
	function c() {
		var b = document.body.clientWidth - a(".navbar-tool-btn").width() - a(".navbar-header").width() - 80,
			c = a(".navbar-main-menu").children().not(".navbar-main-menu-more"),
			d = 0,
			e = !1,
			f = a(".navbar-main-menu-more");
		f.hide().find("ul").empty(), c.each(function() {
			var c = a(this);
			c.show(), d += c.width(), d > b && (e = !0), e && (f.find("ul").append(c.clone()), c.hide())
		}), 1 == f.find("ul").children().length && (c.last().show(), f.find("ul").empty(), e = !1), e && f.show()
	}

	function d() {}
	a(".easy-pie").length && a.each(a(".easy-pie"), function() {
		a(this).easyPieChart({
			barColor: "#dd3f3f",
			size: 32,
			lineWidth: 2,
			trackColor: "#F5F5F5",
			scaleColor: !1,
			easing: "easeOutBounce",
			onStep: function(b, c, d) {
				a(this.el).find(".percent").text(Math.round(d))
			}
		});
		b.chart = a(".easy-pie").data("easyPieChart")
	}), a('[data-toggle="tooltip"]').tooltip(), a('[data-toggle="popover"]').popover(), a(".not-close").click(function() {
		return !1
	}), a(document).bind({
		ready: function() {
			function b() {
				f = setInterval(function() {
					2 > e ? (a(".top-gg-img a").animate({
						top: "-=120px"
					}), e += 1) : e >= 2 && (a(".top-gg-img a").animate({
						top: "+=240px"
					}), e = 0);
					for (var b = 0; b < a(".top-gg-tbna a").length; b++) b == e ? a(".top-gg-tbna a").eq(b).find("div").addClass("opacity_0") : a(".top-gg-tbna a").eq(b).find("div").removeClass("opacity_0")
				}, 3e3)
			}
			var e = 0,
				f = null;
			d(), c(), b(), a(".top-gg-tbna a").each(function(c) {
				a(this).mouseover(function() {
					clearInterval(f), a(".top-gg-img a").stop(), a(".top-gg-img a").animate({
						top: -120 * c + "px"
					}), e = c;
					for (var b = 0; b < a(".top-gg-tbna a").length; b++) b == e ? a(".top-gg-tbna a").eq(b).find("div").addClass("opacity_0") : a(".top-gg-tbna a").eq(b).find("div").removeClass("opacity_0")
				}), a(this).mouseout(function() {
					b()
				})
			})
		},
		click: function(b) {
			for (var c = a(b.target); c.html() || c.attr("class");) {
				if (c.hasClass("member-menu") || c.hasClass("member-toggle")) return;
				c = c.parent()
			}
			a(".member-menu").hide(), a(".member-gzyx").each(function(b) {
				var c = "";
				a(".member-gzyx").eq(b).find(".member-menu div:first-child div span").each(function() {
					c += a(this).html() + "-"
				}), c = c.substring(0, c.length - 1), a(".member-gzyx").eq(b).find("input.member-toggle").val(c), a(".member-gzyx").eq(b).find("input.member-toggle").attr("title", c)
			}), a(".private-gzyx").each(function(b) {
				var c = "";
				a(".private-gzyx").eq(b).find(".member-menu div:first-child div span").each(function() {
					c += a(this).html() + "-"
				}), c = c.substring(0, c.length - 1), a(".private-gzyx").eq(b).find("input.member-toggle").val(c), a(".private-gzyx").eq(b).find("input.member-toggle").attr("title", c)
			})
		}
	}), a(b).bind("resize", function() {
		d(), c()
	}), a(".dropdown-alerts").click(function(a) {
		a.stopPropagation()
	}), a(".dropdown-city a").click(function() {
		if ("javascript:void(0)" == a(this).attr("href")) {
			var c = a(this).data("value");
			a.cookie("haitou_part", c, {
				expires: -1,
				domain: ".haitou.cc"
			}), a.removeCookie("haitou_part"), a.cookie("haitou_part", c, {
				expires: 30,
				path: "/",
				domain: ".haitou.cc"
			}), b.location.reload()
		}
	}), a(":data[data-url]").click(function() {
		var c = a(this).data("url");
		console.log(c), b.open(c)
	}), a(".top-gg-left").each(function() {
		a(this).siblings().length || a(this).css("padding-right", 0)
	})
}(jQuery, window);
var globalAlert = function(a, b) {
		b || (b = "success"), $(".global-alert").addClass("alert-" + b).show().find("span").html(a), setTimeout(function() {
			$(".global-alert").fadeOut(500, function() {
				$(this).removeClass("alert-" + b)
			})
		}, 2e3 + 200 * a.length)
	},
	App = angular.module("App", ["ngSanitize", "ngRoute", "FrameApp", "PointApp"]),
	PointApp = angular.module("PointApp", ["ngSanitize", "HaiTouFilter"]),
	FrameApp = angular.module("FrameApp", ["ngSanitize", "HaiTouFilter"]);
PointApp.controller("PointInfo", ["$scope",
	function(a) {
		var b = function(a) {
				return Math.floor((Math.sqrt(2025 + 20 * a) - 35) / 10)
			},
			c = function(a) {
				return 5 * a * a + 35 * a - 40
			},
			d = JSON.parse($("#myInfo").html());
		"undefined" == typeof d.resume && (d.resume = 0), a.level = b(d.exp), a.exp = d.exp - c(a.level), a.thisLevelExp = c(a.level + 1) - c(a.level), a.expPercentage = Math.floor(100 * a.exp / a.thisLevelExp), a.redTint = Math.floor(a.level / 16), a.yellowTint = Math.floor(a.level % 16 / 4), a.greenTint = Math.floor(a.level % 4)
	}
]), FrameApp.controller("UserManager", ["$scope", "$http", "$location",
	function(a, b, c) {
		//统计模板量
		b.get("templete/count").success(function(r){
			a.tpNum = r;
		});
		
		a.email = "", a.code = "", a.password = "", a.rememberPassword = 1, a.errorMessage = "", a.refreshVerifyCode = function() {
			var a = $(".verify-code"),
				b = a.data("baseurl"),
				c = "?" + Math.random().toString().substr(2);
			a.attr("src", b + c) 
		}, a.switchView = function(b) {
			a.modalView = b, ("register" == b || "forgetPassword" == b) && ($(".verify-code").attr("src") || a.refreshVerifyCode())
		};
		var d = c.path().slice(1); - 1 != ["register", "login", "forgetPassword"].indexOf(d) && ($("#userModal").modal(), a.switchView(d));
		var e = window.location.href.search(/\?backurl=/); - 1 != e && ($("#userModal").modal(), a.switchView("login")), a.toggleRememberPassword = function() {
			a.rememberPassword = 1 - a.rememberPassword
		}, a.register = function() {
			var c = /^[\w][\w\-_\.]*@[\w\-_]+\.[\w\-_\.]+$/;
			if (a.userRegister.email.$setValidity("format", c.test(a.email)), a.userRegister.verifyCode.$setValidity("length", 4 == a.code.length), a.userRegister.$valid) {
				var d = {};
				d.email = a.email, d.code = a.code, a.loading = !0;
				var e = $("body").data("home-url"),
					f = e + "user/register";
				a.errorMessage = "", b({
					method: "get",
					url: f,
					params: d,
					withCredentials: !0
				}).success(function(b) {
					a.loading = !1, "Bad" == b.state ? (a.errorMessage = "* " + b.exception, a.refreshVerifyCode()) : (a.errorMessage = "", a.modalView = "registerNotice", a.openMailUrl = b.returnUrl)
				}).error(function(b) {
					a.loading = !1, a.errorMessage = "* 服务器错误", console.log(b)
				})
			} else a.userRegister.email.$error.required ? a.errorMessage = "* 邮箱不能为空" : a.userRegister.email.$error.format ? a.errorMessage = "* 邮箱格式不正确" : a.userRegister.email.$error.unique ? a.errorMessage = "* 该邮箱已被注册" : a.userRegister.verifyCode.$error.required ? a.errorMessage = "* 验证码不能为空" : a.userRegister.verifyCode.$error.length ? a.errorMessage = "* 验证码错误" : a.userRegister.verifyCode.$error.correct && (a.errorMessage = "* 验证码错误"), $("input.ng-invalid").first().focus()
		}, a.login = function() {
			a.$broadcast("autofill:update");
			var c = /^[\w][\w\-_\.]*@[\w\-_]+\.[\w\-_\.]+$/;
			if (a.userLogin.email.$setValidity("format", c.test(a.email)), a.userLogin.$valid) {
				var d = {},
					e = {};
				d.email = a.email, d.rememberPass = a.rememberPassword, e.pw = hex_md5(a.password), a.loading = !0;
				var f = $("body").data("home-url"),
					g = f + "user/login";
				a.errorMessage = "", b({
					method: "post",
					url: g,
					params: d,
					data: e,
					withCredentials: !0
				}).success(function(b) {
					console.info(b);
					"Bad" == b.state ? (a.loading = !1, a.errorMessage = "* " + b.exception) : (a.errorMessage = "", window.location.reload())
				}).error(function(b) {
					a.loading = !1, a.errorMessage = "* 服务器错误", console.log(b)
				})
			} else a.userLogin.email.$error.required ? a.errorMessage = "* 邮箱不能为空" : a.userLogin.email.$error.format ? a.errorMessage = "* 邮箱格式不正确" : a.userLogin.password.$error.required ? a.errorMessage = "* 密码不能为空" : a.userLogin.password.$error.correct && (a.errorMessage = "* 用户名/密码错误"), $("input.ng-invalid").first().focus()
		}, a.forgetPassword = function() {
			var c = /^[\w][\w\-_\.]*@[\w\-_]+\.[\w\-_\.]+$/;
			if (a.userForgetPassword.email.$setValidity("format", c.test(a.email)), a.userForgetPassword.verifyCode.$setValidity("length", 4 == a.code.length), a.userForgetPassword.$valid) {
				var d = {};
				d.email = a.email, d.code = a.code, a.loading = !0;
				var e = $("body").data("home-url"),
					f = e + "user/findPass";
				a.errorMessage = "", b({
					method: "get",
					url: f,
					params: d,
					withCredentials: !0
				}).success(function(b) {
					a.loading = !1, "Bad" == b.state.state ? (a.errorMessage = "* " + b.exception.ex, a.refreshVerifyCode()) : (a.errorMessage = "", a.modalView = "forgetPasswordNotice", a.openMailUrl = b.data.url)
				}).error(function(b) {
					a.loading = !1, a.errorMessage = "* 服务器错误", console.log(b)
				})
			} else a.userForgetPassword.email.$error.required ? a.errorMessage = "* 邮箱不能为空" : a.userForgetPassword.email.$error.format ? a.errorMessage = "* 邮箱格式不正确" : a.userForgetPassword.email.$error.unique ? a.errorMessage = "* 该邮箱已被注册" : a.userForgetPassword.verifyCode.$error.required ? a.errorMessage = "* 验证码不能为空" : a.userForgetPassword.verifyCode.$error.length ? a.errorMessage = "* 验证码错误" : a.userForgetPassword.verifyCode.$error.correct && (a.errorMessage = "* 验证码错误"), $("input.ng-invalid").first().focus()
		}, a.logout = function() {
			var e = $("body").data("home-url"),
			f = e + "user/logout";
			b({
				method: "get",
				url: f,
				params: {},
				withCredentials: !0
			}).success(function(b) {
				window.location.reload()
			})
		}
	}
]), FrameApp.controller("NavAlertList", ["$scope", "$http",
	function(a, b) {
		b({
			method: "GET",
			url: 'notice/findUnRead',
			params: {},
			withCredentials: !0
		}).success(function(r) {
			a.alertArr = r;
			a.alertNum = r.length;
			a.alertEmpty = a.alertArr.length >= a.alertNum;
		});
		a.bufferSize = 16, a.pageSize = 8, a.requestSize = 24,  a.viewArr = [], a.params = {}, a.markRead = function(b) {
			a.alertNum -= 1;
			var c = a.alertArr[b].id;
			a.alertArr.splice(b, 1), a.communicate(c)
		}, a.markAllRead = function() {
			a.alertNum > a.pageSize ? a.alertNum -= a.pageSize : a.alertNum = 0;
			for (var b = [], c = Math.min(a.pageSize, a.alertArr.length), d = 0; c > d; d++) b.push(a.alertArr[d].id);
			a.alertArr.splice(0, a.pageSize), a.communicate(b)
		}, a.communicate = function(c) {
			a.viewAlerts(c), a.params.view = a.viewArr.toString(), a.alertArr.length < a.bufferSize && !a.alertEmpty && a.getAlerts();
			var d = $("body").data("home-url"),
				e = d + "notice/markRead";
			b({
				method: "GET",
				url: e,
				params: a.params,
				withCredentials: !0
			}).success(function(b) {
				return b.error ? void console.log(b.error) : ("undefined" != typeof b.data && (a.alertArr = a.alertArr.concat(b.data.alert)), b.length < a.requestSize && (a.alertEmpty = !0), a.viewArr = [], void(a.params = {}))
			})
		}, a.viewAlerts = function(b) {
			"object" == typeof b ? a.viewArr = a.viewArr.concat(b) : "number" == typeof b && a.viewArr.push(b)
		}, a.getAlerts = function() {
			var b = a.alertArr[a.alertArr.length - 1],
				c = 0;
			"string" == typeof b.time ? c = Math.round(Date.parse(b.time) / 1e3) : "number" == typeof b.time && (c = b.time), a.params.beginId = b.id, a.params.beginTime = c, a.params.limit = a.requestSize
		}
	}
]), FrameApp.filter("navAlertIcoFilter", function() {
	return function(a) {
		var b = {
			0: "fa-dot-circle-o",
			1: "fa-coffee",
			2: "fa-suitcase",
			3: "fa-file-text",
			4: "fa-comment",
			5: "fa-comments",
			6: "fa-envelope",
			7: "fa-pencil"
		};
		return b[a]
	}
}), FrameApp.filter("navAlertInfoFilter", ["$sce",
	function(a) {
		return function(b) {
			return a.trustAsHtml(b.replace(/<s>/g, " <span class='color'>").replace(/<\/s>/g, " </span>"))
		}
	}
]);
var HaiTouFilter = angular.module("HaiTouFilter", []);
HaiTouFilter.filter("readableTimeFilter", function() {
	return function(a) {
		var b = 0;
		"string" == typeof a ? b = Math.round((new Date).getTime() / 1e3 - Date.parse(a) / 1e3) : "number" == typeof a && (b = Math.round((new Date).getTime() / 1e3 - a));
		var c, d = Math.floor(b / 31104e3),
			e = Math.floor(b % 31104e3 / 2592e3),
			f = Math.floor(b % 2592e3 / 86400),
			g = Math.floor(b % 86400 / 3600),
			h = Math.floor(b % 3600 / 60),
			i = Math.floor(b % 60);
		return c = d ? d + "年前" : e ? e + "月前" : f ? f + "天前" : g ? g + "小时前" : h ? h + "分钟前" : i ? i + "秒前" : "刚刚"
	}
}), HaiTouFilter.filter("typeListFilter", function() {
	return function(a, b) {
		if ("0" === b || "" === b || 0 === b) return a;
		var c = [];
		return a.forEach(function(a) {
			a.kind == b && c.push(a)
		}), c
	}
}), HaiTouFilter.filter("paginationFilter", function() {
	return function(a, b, c) {
		var d = Math.min(0, b * c),
			e = d + c;
		return a.slice(d, e)
	}
}), HaiTouFilter.filter("slice", function() {
	return function(a, b, c) {
		return a.slice(b, c)
	}
}), HaiTouFilter.filter("range", function() {
	return function(a, b) {
		b = parseInt(b);
		for (var c = 0; b > c; c++) a.push(c);
		return a
	}
}), FrameApp.directive("btnLoading", function() {
	return function(a, b, c) {
		a.$watch(function() {
			return a.$eval(c.btnLoading)
		}, function(a) {
			return a ? b.button("loading") : void b.button("reset")
		})
	}
}), FrameApp.directive("autofill", function() {
	return {
		require: "ngModel",
		link: function(a, b, c, d) {
			a.$on("autofill:update", function() {
				d.$setViewValue(b.val())
			})
		}
	}
});